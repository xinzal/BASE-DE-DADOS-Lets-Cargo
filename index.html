<script>
async function enviarDados() {
    const numero = document.getElementById('numero').value;
    const fabrica = document.getElementById('fabrica').value;

    // coleta os itens da tabela
    const linhas = document.querySelectorAll('#tabelaItens tbody tr');
    const itens = Array.from(linhas).map(linha => ({
        codigo: linha.cells[0].innerText,
        descricao: linha.cells[1].innerText,
        quantidade: linha.cells[2].innerText,
        pallets: linha.querySelector('.pallets').value,
        peso: linha.querySelector('.peso').value,
        estoque: linha.querySelector('.estoque').value
    }));

    const dados = { numero, fabrica, itens };

    try {
        const response = await fetch("https://script.google.com/macros/s/SEU_WEBAPPS_URL/exec", {
            method: "POST",
            body: JSON.stringify(dados),
            headers: { "Content-Type": "application/json" }
        });

        const result = await response.json();

        if (result.status === "success") {
            alert("Dados enviados com sucesso!");

            // üü© marca as linhas enviadas com fundo verde
            linhas.forEach(linha => {
                linha.style.backgroundColor = "#d9ead3";
                linha.style.transition = "background-color 0.4s ease";
            });
        } else {
            alert("Erro ao enviar: " + result.message);
        }
    } catch (error) {
        alert("Erro de conex√£o: " + error.message);
    }
}
</script>
